<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kanban-Board | JOIN</title>
    <link rel="shortcut icon" href="./assets/img/JoinLogo.svg" type="image/x-icon">
    <link rel="stylesheet" href="./style.css">
    <link rel="stylesheet" href="./assets/css/icons/icons.css">
    <link rel="stylesheet" href="./responsive.css">
    <link rel="stylesheet" href="./assets/css/board.css">
    <link rel="stylesheet" href="./assets/css/task.css">
    <link rel="stylesheet" href="./assets/css/addTask.css">
    <script src="script.js"></script>
    <script src="./assets/js/firebase-connect.js"></script>
    <script src="./assets/js/board.js"></script>
    <script src="./assets/js/dragging.js"></script>
    <script src="./assets/js/task-view.js"></script>
    <script src="./assets/js/helper-functions.js"></script>
    <script src="./assets/js/addTask.js"></script>
</head>

<body
    onload="renderSidebarHeader(); updateActiveStateNavLink('sidebar-nav-board'); loadTasksFromDatabase(); loadDropTargets(); initEventListenerAddTask(); renderAddTaskData(); setPlaceholder();">

    <!-- Sidebar -->
    <aside id="sidebar" class="sidebar">
    </aside>

    <!-- Main Content Bereich -->
    <div class="container">
        <!-- HEADER -->
        <header id="header" class="header-wrapper">
        </header>

        <main class="main">
            <section class="board-header">
                <h1>Board</h1>
                <div class="right-board-header">
                    <label class="search-label">
                        <input type="text" placeholder="Find Task" onkeyup="search(this.value)">
                        <span></span>
                        <div class="icon icon-search"></div>
                    </label>
                    <button onclick="openAddTask('todo')">Add task</button>
                </div>
            </section>

            <!-- Board columns -->
            <section class="board-middle">
                <div class="boards">
                    <div class="board-title">
                        <h3>To do</h3>
                        <div class="icon icon-add" onclick="openAddTask('todo')"></div>
                    </div>
                    <div class="board-tasks drop-target" id="todo-tasks" title="To do" ondrop="drop(event, 'todo')">
                    </div>
                </div>
                <div class="boards">
                    <div class="board-title">
                        <h3>In progress</h3>
                        <div class="icon icon-add" onclick="openAddTask('progress')"></div>
                    </div>
                    <div class="board-tasks drop-target" id="progress-tasks" title="In progress"
                        ondrop="drop(event, 'progress')">
                    </div>
                </div>
                <div class="boards">
                    <div class="board-title">
                        <h3>Await feedback</h3>
                        <div class="icon icon-add" onclick="openAddTask('await-feedback')"></div>
                    </div>
                    <div class="board-tasks drop-target" id="await-feedback-tasks" title="Await feedback"
                        ondrop="drop(event, 'await-feedback')">
                    </div>
                </div>
                <div class="boards">
                    <div class="board-title">
                        <h3>Done</h3>
                    </div>
                    <div class="board-tasks drop-target" id="done-tasks" title="Done" ondrop="drop(event, 'done')">
                    </div>
                </div>
            </section>

            <!-- Task Detailview Overlay -->
            <div class="overlay" id="overlay" onclick="closeTaskDetail()">
                <div class="task-detail" id="task-detail" onclick="event.stopPropagation();">
                    <div id="close-btn-task-detail" class="close-btn-task-detail" onclick="closeTaskDetail()">
                        <img src="./assets/img/close.svg" alt="Close">
                    </div>
                    <div class="userStory">User Story</div>
                    <h1>Kochwelt Page & Recipe Recommender</h1>
                    <p>Build start page with recipe recommendation.</p>
                    <div class="task-term">
                        <div>
                            <p>Due date:</p>
                            <p>Priority:</p>
                        </div>
                        <div>
                            <p>Date</p>
                            <p>Urgency</p>
                        </div>
                    </div>
                    <div class="assigned">
                        <p>Assigned To:</p>
                        <div id="task-overlay-assigned-contacts">
                            <div class="contributor-placement">
                                <div class="contributor" style="background-color: #f54242;">AB</div>
                                <p>Alfred Bauer</p>
                            </div>
                            <div class="contributor-placement">
                                <div class="contributor" style="background-color: #42f554;">CD</div>
                                <p>Chriss Dreiyr</p>
                            </div>
                            <div class="contributor-placement">
                                <div class="contributor" style="background-color: #4287f5;">EF</div>
                                <p>Elfi Freud</p>
                            </div>
                        </div>
                    </div>
                    <div class="subtask">
                        <p style="margin-bottom: 10px;">Subtask</p>
                        <div class="subtask-checkbox">
                            <div class="check-subtask"><img class="checkbox-img" src="./assets/img/Rectangle 5.svg"
                                    alt=""><span>Implement Recipe Recommendation</span></div>
                            <div class="check-subtask"><img class="checkbox-img" src="./assets/img/Rectangle 5.svg"
                                    alt=""><span>Start Page Layout</span></div>
                        </div>
                        <div class="task-edit-delete">
                            <button class="task-edit-delete-btn"><img src="./assets/img/delete.svg" alt="">
                                <span>Delete</span>
                            </button>
                            <button class="task-edit-delete-btn"><img src="./assets/img/edit.svg" alt="">
                                <span>Edit</span>
                            </button>
                        </div>
                    </div>
                </div>

                <!--wenn edit-task fertig das style aus dem wrapper nehmen und display-non in overlay wieder aktivieren-->
                <div class="edit-task-wrapper" style="position: fixed; top: 10px;left: 5px;">
                    <div class="edit-task" onclick="event.stopPropagation();">
                        <div id="close-btn-task-detail" class="close-btn-task-detail" onclick="closeTaskDetail()">
                            <img src="./assets/img/close.svg" alt="Close">
                        </div>

                        <div class="form-column">
                            <label for="title">Title</label>
                            <input type="text" id="title" name="title" placeholder="Enter a title" required>
    
                            <label for="description">Description</label>
                            <textarea id="description" name="description" rows="4"
                                placeholder="Enter a Description"></textarea>

                            <label for="due-date">Due date</label>
                            <input type="date" id="due-date" name="due-date" required>
                        </div>

                        <div class="priority-assignment">
                            <p>Priority</p>
                            
                            <div class="prio-options edit-task-prio-options">
                                <button type="button" class="prio-btn urgent" onclick="selectPrio('urgent')">Urgent</button>
                                <button type="button" class="prio-btn medium active"
                                    onclick="selectPrio('medium')">Medium</button>
                                <button type="button" class="prio-btn low" onclick="selectPrio('low')">Low</button>
                            </div>

                        </div>

                        <div class="assigned-contributors-to-task">

                            <label for="contactsToAssign" class="assigned-label">Assigned to</label>
                            <select id="contactsToAssign" name="contact" required>
                                <option value="contacts-assign">Select contacts to assign</option>
                            </select>

                                <div class="edit-assigned-contributors">
                                    <div class="contributor" style="background-color: #f54242;">AB</div>
                                    <div class="contributor" style="background-color: #42f554;">CD</div>
                                    <div class="contributor" style="background-color: #4287f5;">EF</div>
                                </div>
                        </div>

                                    <label for="subtasks" class="subtasks-label">Subtasks</label>
                                    <div class="subtask-row">
                                        <input type="text" id="subtasks" name="subtasks" placeholder="Add new subtask">
                                        <button type="button" class="edit-subtask-btn">+</button>
                                    </div>

                                    <div class="edit-task-subtask-listing-wrapper">
                                        <div class="edit-task-subtask-listing">
                                            <p><span class="subtask-dot"></span>Implement Recipe Recommendation</p>
                                        </div>
                                        <div class="edit-task-subtask-listing">
                                            <p><span class="subtask-dot"></span>Start Page Layout</p>
                                        </div>

                                            <button type="submit" class="edit-task-btn">Ok<svg width="25" height="24" 
                                                viewBox="0 0 25 24" fill="white" xmlns="http://www.w3.org/2000/svg">
                                                
                                                                                              
                                                <g mask="url(#mask0_75592_9963)">
                                                    <path
                                                        d="M9.69474 15.15L18.1697 6.675C18.3697 6.475 18.6072 6.375 18.8822 6.375C19.1572 6.375 19.3947 6.475 19.5947 6.675C19.7947 6.875 19.8947 7.1125 19.8947 7.3875C19.8947 7.6625 19.7947 7.9 19.5947 8.1L10.3947 17.3C10.1947 17.5 9.96141 17.6 9.69474 17.6C9.42807 17.6 9.19474 17.5 8.99474 17.3L4.69474 13C4.49474 12.8 4.3989 12.5625 4.40724 12.2875C4.41557 12.0125 4.51974 11.775 4.71974 11.575C4.91974 11.375 5.15724 11.275 5.43224 11.275C5.70724 11.275 5.94474 11.375 6.14474 11.575L9.69474 15.15Z"
                                                        fill="white" />
                                                </g>
                                            </svg>
                                        </button>  
                                       
                                    </div>  
                    </div>

                 </div>

            </div>

            <!-- Add Task Overlay -->
            <div id="add-task-overlay" class="add-task-overlay-wrapper">
                <div id="add-task-container" class="add-task-container">
                    <span class="close-add-task icon-close" onclick="closeAddTask(); resetAddTask()"></span>
                    <h2 id="add-task-title">Add Task</h2>

                    <!-- <form id="add-task-form" class="add-task-form" onsubmit="event.preventDefault(); createAndRenderTask()"> -->
                    <form id="add-task-form" class="add-task-form" novalidate>
                        <div class="form-row">
                            <!-- Left column -->
                            <div class="form-column left">
                                <label for="title">
                                    <div>Title<span class="required">*</span></div>
                                    <input type="text" id="title" name="title" placeholder="Enter a title" required>
                                    <span class="title-error error d-none"></span>
                                </label>

                                <label for="description">
                                    <div>Description</div>
                                    <textarea id="description" name="description" rows="4"
                                        placeholder="Enter a Description"></textarea>
                                </label>

                                <label for="assignees" class="assign-label">
                                    <div>
                                        Assigned to
                                    </div>
                                    <div>
                                        <input type="search" name="assignees" id="assignees"
                                            placeholder="Select contacts to assign" onclick="toggleContactDropdown()">
                                        <div id="assignees-list" class="assignees-list d-none"></div>
                                        <div id="assigned-to" class="assigned-to"></div>
                                    </div>
                                </label>

                            </div>

                            <!-- Right column -->
                            <div class="form-column right">
                                <!-- due date -->
                                <label for="due-date" class="date-label">
                                    <div>Due date<span class="required">*</span></div>
                                    <input type="date" class="picker" id="due-date" name="due-date"
                                        onfocus="clearPlaceholder()" onblur="setPlaceholder()" onchange="formatDate()"
                                        required>
                                    <span class="due-date-error error d-none"></span>
                                </label>

                                <!-- priority -->
                                <label>
                                    <div>Prio</div>
                                    <div class="prio-options">
                                        <div class="prio-btn urgent"
                                            onclick="selectPrio('urgent', '-O9M0Iky4rEYMLq5JwoZ')">
                                            Urgent<span class="icon-urgent"></span>
                                        </div>
                                        <div class="prio-btn medium active"
                                            onclick="selectPrio('medium', '-O9M0Iky4rEYMLq5Jwo_')">
                                            Medium<span class="icon-medium"></span>
                                        </div>
                                        <div class="prio-btn low" onclick="selectPrio('low', '-O9M0IlWMv7MvM-vtcJ-')">
                                            Low <span class="icon-low"></span>
                                        </div>
                                    </div>
                                    <input type="hidden" id="selectedPrio" name="prio" value="-O9M0Iky4rEYMLq5Jwo_">
                                </label>

                                <!-- category -->
                                <label for="category" class="category-label">
                                    <div>Category<span class="required">*</span></div>
                                    <select id="category" name="category" placeholder="Select task category"
                                        onclick="categoryDropDown();" required>
                                    </select>
                                    <span class="category-error error d-none"></span>
                                </label>

                                <!-- subtasks -->
                                <label for="subtasks">
                                    <div>Subtasks</div>
                                    <div class="subtask-row">
                                        <input type="text" id="subtasks" name="subtasks" placeholder="Add new subtask">
                                        <div class="subtask-buttons">
                                            <button type="button" class="clear-subtask-btn icon-close"
                                                onclick="clearSubtaskInput()"></button>
                                            <button type="button" class="add-subtask-btn icon-add"
                                                onclick="addSubtask()"></button>
                                        </div>
                                    </div>
                                    <ul id="subtask-list" class="subtask-list">
                                        <!-- Dynamic subtask list -->
                                    </ul>

                                    <span class="required-text mobile"><span class="required">*</span>This field is
                                        required</span>
                                </label>
                            </div>
                        </div>

                        <div class="form-actions">
                            <span class="required-text desktop">
                                <span class="required">*</span>This field is required
                            </span>
                            <div class="add-task-button-wrapper">
                                <!-- Clear Button -->
                                <button type="button" class="cancel-btn" onclick="closeAddTask(); resetAddTask()">
                                    Cancel<span class="icon-close"></span>
                                </button>
                                <!-- Create Button -->
                                <button id="createTaskBtn" type="submit" class="create-task-btn" disabled>
                                    Create Task<span class="icon-check"></span>
                                </button>
                            </div>
                        </div>
                    </form>

                </div>
            </div>

        </main>
    </div>

</body>

</html>