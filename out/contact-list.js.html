<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: contact-list.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: contact-list.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>let groupedUsers = {};

/**
 * This function is called onload in body of contacts.html.
 * It fetches the user data from the database, writing it into users, and renders the contact list by calling two other functions
 */
async function renderContactList() {
  let users = await getData("users");
  getFirstLetters(users);
  displayContactList();
}

/**
 * This function sorts the users alphabetically (this is necessary because the contact list must be sorted alphabetically).
 * From these sortedUsers, it extracts the first letter of every name and creates an empty array in the groupedUsers object if that array doesn't exist already.
 * It also extracts the initials of the first and last name of a user and assigns them to initials.
 * Finally, it creates a copy of each user and adds the initials to it, pushing each user object with their initials into groupedUsers.
 * The keys of groupedUsers are the first letters that exist in the user database (for grouping), the values are the respective user objects that start with that letter.
 *
 * @param {object} users
 */
function getFirstLetters(users) {
  let sortedUsers = Object.keys(users).sort((a, b) => {
    return users[a].name.localeCompare(users[b].name);
  });
  sortedUsers.forEach((key) => {
    let user = users[key];
    let firstLetter = user.name[0].toUpperCase();
    let initials = user.name.split(" ").map((name, index, array) => {
        if (index === 0 || index === array.length - 1) {
          return name[0].toUpperCase();
        }
        return "";
      }).join("");
    if (!groupedUsers[firstLetter]) {
      groupedUsers[firstLetter] = [];
    }
    groupedUsers[firstLetter].push({ ...user, initials });
  });
}

/**
 * This function uses the global groupedUsers object and creates HTML for every key-value pair of that object, i.e. displaying the users.
 * It first gets the template for the basic HTML structure for the letter category.
 * Then, it gets the template for every user, placing these within the respective letter category that they belong to.
 */
function displayContactList() {
  Object.keys(groupedUsers).forEach((letter) => {
    let listRef = document.getElementById("contact-list-list");
    listRef.innerHTML += getLetterGroupTemplate(letter);
    groupedUsers[letter].forEach((user) => {
      let letterRef = document.getElementById("contact-list-item-" + letter);
      letterRef.innerHTML += getUserContactListTemplate(user);
    });
  });
}

/**
 * This template function returns the HTML structure for a letter category.
 * It takes a letter (i.e. 'A') and returns the HTML accordingly
 *
 * @param {string} letter
 * @returns HTML Structure
 */
function getLetterGroupTemplate(letter) {
  return /*html*/ `
        &lt;div id="contact-list-item-${letter}" class="contact-list-item">
                    &lt;div class="contact-list-letter">${letter}&lt;/div>
                    &lt;div class="contact-list-hr">&lt;/div>
            &lt;/div>
    `;
}

/**
 * This template function returns the HTML structure for a user.
 * It takes the user object and returns the HTML accordingly.
 *
 * @param {object} user
 * @returns HTML Structure
 */
function getUserContactListTemplate(user) {
  return /*html*/ `
        &lt;div id="contact-list-user-${user.id}" class="contact-list-contact" onclick="console.log('Open Contact with id ${user.id}')">
                        &lt;div class="contact-list-profile" style="background-color: ${user.color};">${user.initials}&lt;/div>
                        &lt;div class="contact-list-contact-info">
                            &lt;p>${user.name}&lt;/p>
                            &lt;a href="mailto:${user.email}">${user.email}&lt;/a>
                        &lt;/div>
                    &lt;/div>
    `;
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#displayContactList">displayContactList</a></li><li><a href="global.html#getFirstLetters">getFirstLetters</a></li><li><a href="global.html#getLetterGroupTemplate">getLetterGroupTemplate</a></li><li><a href="global.html#getUserContactListTemplate">getUserContactListTemplate</a></li><li><a href="global.html#renderContactList">renderContactList</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.3</a> on Sun Oct 13 2024 21:25:10 GMT+0200 (Mitteleurop√§ische Sommerzeit)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
